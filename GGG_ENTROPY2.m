% Gallagher



function result = GGG_ENTROPY(T,H)

ETA = [0.12523341,0.36783150,0.58731795,0.76990267,0.90411726,0.98156063];
W = [0.24914705,0.23349254,0.20316743,0.16007833,0.10693933,0.04717534];
s0 = (2.3*10^-7*T^3-6.385*10^-2/2*T^-2+5.096*10^-2/3*T^-3-(2.3*10^-7-6.385*10^-2/2+5.096*10^-2/3))*1000;
sSum = 0;
vdMdT1=0;
vdMdT2=0;

C0=13.67388+2.718523*T+0.1278728*T^2-2.5072373*10^-3*T^3;
C1=-2.980799+0.9144735*T-7.3461875*10^-2*T^2+1.1088194*10^-3*T^3+9.8684995*10^-6*T^4;
C2=3.166695-0.6364962*T+4.8334930*10^-2*T^2-1.0840200*10^-3*T^3+4.3787923*10^-6*T^4;
C3=-0.3461423+9.0944469*10^-2*T-6.9979527*10^-3*T^2+1.3868879*10^-4*T^3;
C4=1.3560383*10^-2-4.1968897*10^-3*T+3.3840450*10^-4*T^2-6.8436516*10^-6*T^3;

dC0dT=2.718523+2*0.1278728*T-3*2.5072373*10^-3*T^2;
dC1dT=0.9144735-2*7.3461875*10^-2*T+3*1.1088194*10^-3*T^2+4*9.8684995*10^-6*T^3;
dC2dT=-0.6364962+2*4.8334930*10^-2*T-3*1.0840200*10^-3*T^2+4*4.3787923*10^-6*T^3;
dC3dT=9.0944469*10^-2-2*6.9979527*10^-3*T+3*1.3868879*10^-4*T^2;
dC4dT=-4.1968897*10^-3+2*3.3840450*10^-4*T-3*6.8436516*10^-6*T^2;


for i = 1:6
    
    x1 = H/2*(1+ETA(i));
    x2 = H/2*(1-ETA(i));
    
    DEN=C0+C1*x1+C2*x1^2+C3*x1^3+C4*x1^4;
    dDENdT=dC0dT+dC1dT*x1+dC2dT*x1^2+dC3dT*x1^3+dC4dT*x1^4;
    vdMdT1 = -x1*dDENdT/DEN^2*1000;
    
    
    DEN=C0+C1*x2+C2*x2^2+C3*x2^3+C4*x2^4;
    dDENdT=dC0dT+dC1dT*x2+dC2dT*x2^2+dC3dT*x2^3+dC4dT*x2^4;
    vdMdT2 = -x2*dDENdT/DEN^2*1000;
    
    sSum = sSum + W(i)*(vdMdT1+vdMdT2);
end

% cs are [g] unit! So multiply 1000

result = s0 + H/2*sSum;
if T<1
    result=(GGG_ENTROPY(1,H)+9.6938)*(T-0.7)/(1-0.7)-9.6938;
end
end


